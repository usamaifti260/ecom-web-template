(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{1221:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(7876),a=t(4232),n=t(9099),i=t(7328),c=t.n(i),l=t(4587),o=t.n(l),d=t(8230),m=t.n(d),x=t(1040),u=t(7169),p=t(1782),h=t(7954);let y={siteId:h.Ay.siteId,apiBaseUrl:h.Ay.payment.apiBaseUrl,apiTimeout:(0,h.Jh)().timeout,loadingText:"Loading order details...",placingOrderText:"Placing Order...",placeOrderButtonText:"Place Order",securityText:"Your order is secure and protected",codTitle:"Cash on Delivery",codDescription:"Pay when you receive your order",codHowItWorksTitle:"How it works:",codSteps:["Your fashion items will be carefully packaged","Pay the delivery person when your order arrives","Inspect your products before payment","Cash payment only at delivery"],returnPolicyDays:7,returnPolicyTitle:"7-Day Quality Guarantee",returnPolicyPoints:["Quality guarantee & returns within 7 days for quality issues","Items must be in original condition with packaging","Free return pickup for quality issues","Full refund or exchange as per your preference"],satisfactionTitle:"Quality Guarantee",satisfactionText:"Not satisfied with quality? Return within 7 days for a full refund!",paymentIcon:"\uD83D\uDCB3",codIcon:"\uD83D\uDCB0",returnIcon:"\uD83D\uDD04",deliveryIcon:"\uD83D\uDE9A",summaryIcon:"\uD83E\uDDFE",guaranteeIcon:"✓",securityIcon:"\uD83D\uDD12",shopRoute:"/shop",checkoutRoute:"/checkout",successRoute:"/order-success",failureRoute:"/order-failed"};function g(){let e=(0,n.useRouter)(),{clearCart:s}=(0,u._$)(),{showErrorNotification:t,showSuccessNotification:i}=(0,p.hN)(),[l,d]=(0,a.useState)(null),[g,j]=(0,a.useState)(!1),[b,f]=(0,a.useState)("COD");(0,a.useEffect)(()=>{try{let s=localStorage.getItem("pendingOrder");s?d(JSON.parse(s)):e.push(y.checkoutRoute)}catch(s){console.error("Error loading order data:",s),e.push(y.checkoutRoute)}},[e]);let N=e=>"".concat(h.Ay.currency," ").concat(e.toFixed(0)),v=()=>{let e=Date.now().toString(36),s=Math.random().toString(36).substr(2,5);return"MK-".concat(e,"-").concat(s).toUpperCase()},w=async()=>{var r,a,n,c,o,d,m,u,p,h,g;if(!l)return void t("Order data not found. Please try again.");j(!0);try{let t={name:"".concat(l.customer.firstName," ").concat(l.customer.lastName).trim(),email:l.customer.email,phone:l.customer.phone,address:l.customer.address,city:l.customer.city,state:l.customer.state,zipCode:l.customer.zipCode,country:l.customer.country,notes:l.customer.notes},c=l.items.map(e=>({id:e.id.toString(),name:e.name,description:e.description||e.name,price:e.price,quantity:e.quantity,category:e.category||"",image:e.image||"",brand:e.brand||y.defaultBrand,inStock:e.inStock||!0,selectedConfiguration:e.selectedConfiguration||null})),o=l.summary.subtotal,d=l.summary.shippingFee||0,m=o+d,u={subtotal:parseFloat(o.toFixed(2)),tax:parseFloat("0.00"),shipping:parseFloat(d.toFixed(2)),discount:parseFloat("0.00"),total:parseFloat(m.toFixed(2))},p=await x.A.post("".concat(y.apiBaseUrl,"/").concat(y.siteId),{customerData:t,products:c,totals:u,paymentInfo:{method:{COD:"cash",card:"card",paypal:"paypal"}[b]||"cash",status:"pending"}},{headers:{"Content-Type":"application/json"},timeout:y.apiTimeout});console.log("Order submitted successfully:",p.data);let h=(null==(r=p.data)?void 0:r.orderNumber)||v(),g={...l,orderId:h,backendOrderId:null==(a=p.data)?void 0:a.id,backendOrderNumber:null==(n=p.data)?void 0:n.orderNumber,status:"confirmed",paymentMethod:b,paymentStatus:"pending",processedAt:new Date().toISOString(),backendResponse:p.data,totals:u},j=JSON.parse(localStorage.getItem("orders")||"[]");j.push(g),localStorage.setItem("orders",JSON.stringify(j)),localStorage.removeItem("pendingOrder"),s(),i("Order placed successfully!"),e.push("".concat(y.successRoute,"?orderId=").concat(h))}catch(n){console.error("Order submission failed:",n),console.error("Error response:",n.response),console.error("Error response data:",null==(c=n.response)?void 0:c.data),console.error("Error response status:",null==(o=n.response)?void 0:o.status);let s="Failed to place order. Please try again.";(null==(m=n.response)||null==(d=m.data)?void 0:d.message)?s=n.response.data.message:n.message&&(s=n.message),t("Order submission failed: ".concat(s));let r={...l,error:(null==(u=n.response)?void 0:u.data)||{message:s},failedAt:new Date().toISOString(),paymentMethod:b};localStorage.setItem("lastFailedOrder",JSON.stringify(r));let a=(null==(p=n.response)?void 0:p.status)===400?"address_invalid":(null==(h=n.response)?void 0:h.status)===409?"inventory_unavailable":(null==(g=n.response)?void 0:g.status)>=500?"system_error":"payment_failed";e.push("".concat(y.failureRoute,"?reason=").concat(a))}finally{j(!1)}};return l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:(0,h.Pl)("payment").title}),(0,r.jsx)("meta",{name:"description",content:(0,h.Pl)("payment").description}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:h.Ay.faviconPath,type:"image/png",sizes:h.Ay.faviconSize})]}),(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4",children:[(0,r.jsx)(m(),{href:y.shopRoute,className:"hover:text-brand-accent transition-colors",children:"\uD83D\uDC57 Shop"}),(0,r.jsx)("span",{children:"→"}),(0,r.jsx)(m(),{href:y.checkoutRoute,className:"hover:text-brand-accent transition-colors",children:"Checkout"}),(0,r.jsx)("span",{children:"→"}),(0,r.jsx)("span",{className:"text-brand-primary font-medium",children:"Payment"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:(0,r.jsx)("span",{className:"bg-gradient-to-r from-brand-primary to-brand-accent bg-clip-text text-transparent",children:(0,h.Pl)("payment").title})}),(0,r.jsx)("p",{className:"text-gray-600",children:(0,h.Pl)("payment").description})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-brand-primary mb-6 flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:y.paymentIcon}),"Payment Method"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"border border-brand-accent rounded-lg p-4 bg-gradient-to-r from-brand-primary to-brand-accent",children:(0,r.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"paymentMethod",value:"COD",checked:"COD"===b,onChange:e=>f(e.target.value),className:"mt-1 w-4 h-4 text-brand-primary border-white focus:ring-brand-accent"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-lg",children:y.codIcon})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold text-white",children:y.codTitle}),(0,r.jsx)("p",{className:"text-sm text-white opacity-90",children:y.codDescription})]})]}),(0,r.jsxs)("div",{className:"mt-3 p-3 bg-black bg-opacity-20 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-white font-semibold",children:y.codHowItWorksTitle}),(0,r.jsx)("ul",{className:"text-sm text-white opacity-90 mt-1 space-y-1",children:y.codSteps.map((e,s)=>(0,r.jsxs)("li",{children:["• ",e]},s))})]})]})]})}),(0,r.jsx)("div",{className:"border border-gray-300 rounded-lg p-4 opacity-50 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-lg",children:"\uD83D\uDCB3"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-500",children:"Credit/Debit Card"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Coming soon"})]})]})})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-brand-primary mb-6 flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:y.returnIcon}),"Quality Guarantee & Return Policy"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-green-800 mb-2",children:y.returnPolicyTitle}),(0,r.jsx)("ul",{className:"text-sm text-green-700 space-y-1",children:y.returnPolicyPoints.map((e,s)=>(0,r.jsxs)("li",{children:["• ",e]},s))})]})]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Questions about returns?",(0,r.jsxs)("a",{href:"tel:".concat(h.Ay.businessContact),className:"text-brand-accent hover:text-brand-primary font-medium ml-1",children:["Call us at ",h.Ay.businessContact]})]})})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-brand-primary mb-6 flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:y.deliveryIcon}),"Delivery Information"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-brand-primary",children:"Customer"}),(0,r.jsxs)("p",{className:"text-sm text-gray-800",children:[l.customer.firstName," ",l.customer.lastName]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-brand-primary",children:"Email"}),(0,r.jsx)("p",{className:"text-sm text-gray-800",children:l.customer.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-brand-primary",children:"Phone"}),(0,r.jsx)("p",{className:"text-sm text-gray-800",children:l.customer.phone})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-brand-primary",children:"Delivery Address"}),(0,r.jsxs)("p",{className:"text-sm text-gray-800",children:[l.customer.address,(0,r.jsx)("br",{}),l.customer.city,", ",l.customer.area," ",l.customer.zipCode]})]}),l.customer.notes&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-brand-primary",children:"Order Notes"}),(0,r.jsx)("p",{className:"text-sm text-gray-800",children:l.customer.notes})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-200 h-fit",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-brand-primary mb-6 flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:y.summaryIcon}),"Order Summary"]}),(0,r.jsx)("div",{className:"space-y-4 mb-6",children:l.items.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center space-x-4 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsx)("div",{className:"relative w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:(0,r.jsx)(o(),{src:e.image,alt:e.name,fill:!0,className:"object-cover"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-800 truncate",children:e.name}),e.selectedConfiguration&&Object.keys(e.selectedConfiguration).length>0&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[e.selectedConfiguration.size&&(0,r.jsxs)("span",{className:"inline-block mr-2",children:["Size: ",e.selectedConfiguration.size]}),e.selectedConfiguration.color&&(0,r.jsxs)("span",{className:"inline-block mr-2",children:["Color: ",e.selectedConfiguration.color]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Quantity: ",e.quantity]})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsx)("p",{className:"text-sm font-semibold bg-gradient-to-r from-brand-primary to-brand-accent bg-clip-text text-transparent",children:N(e.price*e.quantity)})})]},"".concat(e.id,"-").concat(e.selectedSize,"-").concat(s)))}),(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["Subtotal (",l.summary.itemCount," items)"]}),(0,r.jsx)("span",{className:"font-medium text-gray-800",children:N(l.summary.subtotal)})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Shipping"}),(0,r.jsx)("span",{className:"font-medium text-green-600",children:0===l.summary.shippingFee?"FREE":N(l.summary.shippingFee)})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-2",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-base font-semibold text-gray-800",children:"Total"}),(0,r.jsx)("span",{className:"text-base font-semibold bg-gradient-to-r from-brand-primary to-brand-accent bg-clip-text text-transparent",children:N(l.summary.total)})]})})]}),(0,r.jsx)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-lg",children:y.guaranteeIcon})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-green-800",children:y.satisfactionTitle}),(0,r.jsx)("p",{className:"text-sm text-green-700",children:y.satisfactionText})]})]})}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("button",{onClick:w,disabled:g,className:"w-full py-4 px-6 rounded-lg font-bold text-lg transition-all duration-200 ".concat(g?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-brand-primary to-brand-accent hover:from-brand-accent hover:to-brand-primary transform hover:scale-105"," text-white"),children:g?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),y.placingOrderText]}):y.placeOrderButtonText}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-center space-x-2 text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"text-lg",children:y.securityIcon}),(0,r.jsx)("span",{children:y.securityText})]})]})]})]})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:(0,h.Pl)("payment").title}),(0,r.jsx)("meta",{name:"description",content:(0,h.Pl)("payment").description}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:h.Ay.faviconPath,type:"image/png",sizes:h.Ay.faviconSize})]}),(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-accent mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:y.loadingText})]})})]})}},2020:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/payment",function(){return t(1221)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[40,636,593,792],()=>s(2020)),_N_E=e.O()}]);